{# Copyright (C) 2015 Hewlett Packard Enterprise Development LP
#  All Rights Reserved.
#
#  Licensed under the Apache License, Version 2.0 (the "License"); you may
#  not use this file except in compliance with the License. You may obtain
#  a copy of the License at
#
#      http://www.apache.org/licenses/LICENSE-2.0
#
#  Unless required by applicable law or agreed to in writing, software
#  distributed under the License is distributed on an "AS IS" BASIS, WITHOUT
#  WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied. See the
#  License for the specific language governing permissions and limitations
#  under the License.
#}{% extends "layout.html" %}
{% block body %}
<h1>OVSDB Update Benchmark</h1>
<div class="panel panel-primary">
    <div class="panel-heading">
        <h2>Configure Test</h2>
    </div>
    <div class="panel-body">
        <form method="post" action="{{ url_for('ovsdb_update') }}">
            <div class="form-group">
                <label for="ovsdb-update-number">Requests per Worker</label>
                <input type="number" class="form-control" id="ovsdb-update-number" placeholder="Updates per Worker" min="1" max="5000000" name="quantity">
            </div>
            <div class="form-group">
                <label for="ovsdb-update-workers">Count of Workers</label>
                <input type="number" class="form-control" id="ovsdb-update-workers" placeholder="Number of parallel workers" min="1" max="1000" name="workers">
            </div>
            <div class="form-group">
                <label for="ovsdb-update-poolsize">Size of the pool of recoreds to be updated</label>
                <input type="number" class="form-control" id="ovsdb-update-poolsize" placeholder="Record Pool Size" min="1" max="5000000" name="poolsize">
            </div>
            <div class="form-group">
                <div class="checkbox">
                    <label>
                        <input type="checkbox" checked name="cache"> Enable cache
                    </label>
                </div>
            </div>
            <div class="form-group">
                <button type="submit" class="btn btn-primary">Launch Test</button>
            </div>
        </form>
    </div>
</div>
{% if results %}
<h1>Results of Last Test</h1>
<dl>
<dt>Test</dt><dd>Update test</dd>
<dt>Number of Workers</dt><dd>{{ results.workers }}</dd>
<dt>Requests per Worker</dt><dd>{{ results.quantity }}</dd>
<dt>Pool size</dt><dd>{{ results.poolsize }}</dd>
<dt>Enabled cache?</dt><dd>{{ results.cache }}</dd>
</dl>
<div class="panel panel-info">
    <div class="panel-heading">
        <h2>Responses per Second vs Mean Response Time</h2>
    </div>
    <div class="panel-body">
        <img src="/plot/throughtput-latency/ovsdb-update.png">
    </div>
</div>
<div class="panel panel-info">
    <div class="panel-heading">
        <h2>Responses per Second and Response Time vs Time</h2>
    </div>
    <div class="panel-body">
        <img src="/plot/responses/ovsdb-update.png">
    </div>
</div>
<div class="panel panel-info">
    <div class="panel-heading">
        <h2>OVSDB Server - Memory Usage</h2>
    </div>
    <div class="panel-body">
        <img src="/plot/memory/ovsdb-update.png">
    </div>
</div>
<div class="panel panel-info">
    <div class="panel-heading">
        <h2>OVSDB Server - CPU Usage</h2>
    </div>
    <div class="panel-body">
        <img src="/plot/cpu/ovsdb-update.png">
    </div>
</div>
{% endif%}
{% endblock %}
